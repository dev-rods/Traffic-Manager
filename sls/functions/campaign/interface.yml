CampaignOrchestrator:
  handler: src/functions/campaign/orchestrator.handler
  memorySize: 512
  iamRoleStatementsName: ${self:service}-${self:custom.stage}-CampaignOrchestrator-lambdaRole
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Query
        - dynamodb:Scan
        - dynamodb:GetItem
        - dynamodb:PutItem
        - dynamodb:UpdateItem
        - dynamodb:DeleteItem
      Resource:
        - "arn:aws:dynamodb:${self:provider.region}:${aws:accountId}:table/${self:custom.resourcePrefix}-*"
        - "arn:aws:dynamodb:${self:provider.region}:${aws:accountId}:table/${self:custom.resourcePrefix}-*/index/*"
    - Effect: Allow
      Action:
        - logs:CreateLogGroup
        - logs:CreateLogStream
        - logs:PutLogEvents
      Resource: "arn:aws:logs:*:*:*"

CampaignRecorder:
  handler: src/functions/campaign/recorder.handler
  memorySize: 512
  iamRoleStatementsName: ${self:service}-${self:custom.stage}-CampaignRecorder-lambdaRole
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Query
        - dynamodb:Scan
        - dynamodb:GetItem
        - dynamodb:PutItem
        - dynamodb:UpdateItem
        - dynamodb:DeleteItem
      Resource:
        - "arn:aws:dynamodb:${self:provider.region}:${aws:accountId}:table/${self:custom.resourcePrefix}-*"
        - "arn:aws:dynamodb:${self:provider.region}:${aws:accountId}:table/${self:custom.resourcePrefix}-*/index/*"
    - Effect: Allow
      Action:
        - logs:CreateLogGroup
        - logs:CreateLogStream
        - logs:PutLogEvents
      Resource: "arn:aws:logs:*:*:*"

ErrorNotifier:
  handler: src/functions/campaign/error_notifier.handler
  memorySize: 512
  iamRoleStatementsName: ${self:service}-${self:custom.stage}-ErrorNotifier-lambdaRole
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Query
        - dynamodb:Scan
        - dynamodb:GetItem
        - dynamodb:PutItem
        - dynamodb:UpdateItem
        - dynamodb:DeleteItem
      Resource:
        - "arn:aws:dynamodb:${self:provider.region}:${aws:accountId}:table/${self:custom.resourcePrefix}-*"
        - "arn:aws:dynamodb:${self:provider.region}:${aws:accountId}:table/${self:custom.resourcePrefix}-*/index/*"
    - Effect: Allow
      Action:
        - logs:CreateLogGroup
        - logs:CreateLogStream
        - logs:PutLogEvents
      Resource: "arn:aws:logs:*:*:*"